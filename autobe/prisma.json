{"files":[{"filename":"schema-01-systematic.prisma","namespace":"Systematic","models":[{"name":"todo_app_service_configurations","description":"System-wide configuration items keyed by namespace and key with optional environment scoping. Holds raw string values with an explicit value_type for interpretation at runtime. Managed by administrators and referenced by application services for behavior switches. Optionally linked to a governing policy {@link todo_app_service_policies} and created by a user {@link todo_app_users}. Records support lifecycle via active flag and effective window.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_user_id","type":"uuid","description":"Administrative actor who last created/updated this configuration. Target model's {@link todo_app_users.id}.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id","onDelete":"SetNull"},"unique":false,"nullable":true},{"name":"todo_app_service_policy_id","type":"uuid","description":"Optional governing policy for this configuration. Target model's {@link todo_app_service_policies.id}.","relation":{"name":"policy","targetModel":"todo_app_service_policies","targetField":"id","onDelete":"SetNull"},"unique":false,"nullable":true}],"plainFields":[{"name":"namespace","type":"string","description":"Logical grouping for configuration keys (e.g., \"core\", \"auth\", \"billing\"). Used to segment settings by domain.","nullable":false},{"name":"environment","type":"string","description":"Optional environment discriminator (e.g., \"prod\", \"staging\", \"dev\"). Null indicates environment-agnostic.","nullable":true},{"name":"key","type":"string","description":"Business key name unique within (namespace, environment). Case-insensitive comparisons are handled at application level if needed.","nullable":false},{"name":"value","type":"string","description":"Stored configuration value in raw string form. Consumers interpret according to value_type.","nullable":false},{"name":"value_type","type":"string","description":"Type hint for interpreting the stored value (e.g., \"string\", \"int\", \"double\", \"boolean\", \"datetime\", \"uri\").","nullable":false},{"name":"is_secret","type":"boolean","description":"Whether this value is sensitive and should be redacted in logs and listings.","nullable":false},{"name":"description","type":"string","description":"Human-readable description and operational notes for this configuration key.","nullable":true},{"name":"active","type":"boolean","description":"Whether this configuration is currently enabled for evaluation.","nullable":false},{"name":"effective_from","type":"datetime","description":"Optional activation start time for the configuration in business terms.","nullable":true},{"name":"effective_to","type":"datetime","description":"Optional deactivation time after which the configuration is not applied.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp for this configuration record.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for this configuration record.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp. Null indicates the record is active/not deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["namespace","key","environment"],"unique":true}],"plainIndexes":[{"fieldNames":["active","namespace","environment"]},{"fieldNames":["namespace","created_at"]},{"fieldNames":["todo_app_service_policy_id","active"]}],"ginIndexes":[{"fieldName":"key"},{"fieldName":"description"}]},{"name":"todo_app_service_policies","description":"Business policies governing application behavior, rate limits, retention, and other constraints. Each policy has a globally unique code and stores a raw value as string with value_type indicating how to interpret it. Managed independently by administrators; referenced by other entities including {@link todo_app_service_configurations} and {@link todo_app_feature_flags}. Created-by user reference links to {@link todo_app_users}.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_user_id","type":"uuid","description":"Administrative owner/creator of this policy. Target model's {@link todo_app_users.id}.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id","onDelete":"SetNull"},"unique":false,"nullable":true}],"plainFields":[{"name":"namespace","type":"string","description":"Logical grouping for the policy (e.g., \"auth\", \"security\", \"privacy\").","nullable":false},{"name":"code","type":"string","description":"Globally unique policy code used by services to look up the policy.","nullable":false},{"name":"name","type":"string","description":"Human-readable name of the policy.","nullable":false},{"name":"description","type":"string","description":"Detailed business description and operational guidance for this policy.","nullable":true},{"name":"value","type":"string","description":"Policy value stored as raw string; interpreted by services using value_type.","nullable":false},{"name":"value_type","type":"string","description":"Type hint for interpreting the policy value (e.g., \"string\", \"int\", \"double\", \"boolean\", \"datetime\", \"uri\").","nullable":false},{"name":"active","type":"boolean","description":"Whether this policy is currently in effect.","nullable":false},{"name":"effective_from","type":"datetime","description":"Optional activation start time for the policy in business terms.","nullable":true},{"name":"effective_to","type":"datetime","description":"Optional end time after which the policy is no longer in effect.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp for this policy record.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for this policy record.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp. Null indicates the record is active/not deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["code"],"unique":true}],"plainIndexes":[{"fieldNames":["active","namespace"]},{"fieldNames":["effective_from","effective_to"]},{"fieldNames":["todo_app_user_id","active"]}],"ginIndexes":[{"fieldName":"name"},{"fieldName":"description"}]},{"name":"todo_app_feature_flags","description":"Feature flag definitions for conditional enablement and staged rollouts. Supports environment and namespace scoping, percentage rollouts, and optional targeting notes. Administrators manage flags independently; flags may optionally be associated with a governing policy {@link todo_app_service_policies} and are created by {@link todo_app_users}.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_service_policy_id","type":"uuid","description":"Optional governing policy reference. Target model's {@link todo_app_service_policies.id}.","relation":{"name":"policy","targetModel":"todo_app_service_policies","targetField":"id","onDelete":"SetNull"},"unique":false,"nullable":true},{"name":"todo_app_user_id","type":"uuid","description":"Administrative owner/creator of the feature flag. Target model's {@link todo_app_users.id}.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id","onDelete":"SetNull"},"unique":false,"nullable":true}],"plainFields":[{"name":"namespace","type":"string","description":"Logical grouping for the feature flag (e.g., \"ui\", \"payments\", \"sync\").","nullable":false},{"name":"environment","type":"string","description":"Deployment environment for the flag (e.g., \"prod\", \"staging\", \"dev\"). Null indicates environment-agnostic.","nullable":true},{"name":"code","type":"string","description":"Unique flag code within (namespace, environment). Used by services to evaluate features.","nullable":false},{"name":"name","type":"string","description":"Human-readable name of the feature flag.","nullable":false},{"name":"description","type":"string","description":"Business description, rollout plan, and guardrail notes for this flag.","nullable":true},{"name":"active","type":"boolean","description":"Whether the flag is enabled for evaluation.","nullable":false},{"name":"rollout_percentage","type":"int","description":"Percentage-based rollout for progressive exposure (0–100). Applied only when active.","nullable":false},{"name":"target_audience","type":"string","description":"Optional description of intended audience or segmentation rules in business terms.","nullable":true},{"name":"start_at","type":"datetime","description":"Optional start time when the flag begins evaluation.","nullable":true},{"name":"end_at","type":"datetime","description":"Optional end time after which the flag is no longer evaluated.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp for this feature flag record.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for this feature flag record.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp. Null indicates the record is active/not deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["namespace","code","environment"],"unique":true}],"plainIndexes":[{"fieldNames":["active","namespace","environment"]},{"fieldNames":["rollout_percentage","namespace"]},{"fieldNames":["todo_app_service_policy_id","active"]}],"ginIndexes":[{"fieldName":"name"},{"fieldName":"description"}]}]},{"filename":"schema-02-actors.prisma","namespace":"Actors","models":[{"name":"todo_app_users","description":"Core user accounts for the todoApp. Stores authentication credentials, account lifecycle status, and verification state. Serves as the parent entity for user profile, preferences, sessions, and role assignments. Other actor-related models reference this model via 1:1 relationships. This table is central to access control and privacy boundaries.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"email","type":"string","description":"User's unique email address for authentication and notifications. Acts as the login identifier. Must be unique across the system.","nullable":false},{"name":"password_hash","type":"string","description":"Argon2/bcrypt or similar password hash. Never store plaintext passwords.","nullable":false},{"name":"status","type":"string","description":"Account lifecycle state (e.g., pending_verification, active, suspended, deactivated). Controls whether the user can authenticate.","nullable":false},{"name":"email_verified","type":"boolean","description":"Whether the user's email has been verified according to policy.","nullable":false},{"name":"verified_at","type":"datetime","description":"Timestamp when email was verified. Null until verification completes.","nullable":true},{"name":"last_login_at","type":"datetime","description":"Timestamp of the last successful login for user activity tracking and security reviews.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp for the user record.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for the user record.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp. When set, the record is considered deleted and excluded from normal flows.","nullable":true}],"uniqueIndexes":[{"fieldNames":["email"],"unique":true}],"plainIndexes":[{"fieldNames":["status","created_at"]}],"ginIndexes":[]},{"name":"todo_app_user_profiles","description":"Supplemental user profile information attached to a single {@link todo_app_users} account. Contains human-facing attributes for display and search. Managed through the owning user; not independently meaningful for access control.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_user_id","type":"uuid","description":"Owning user's {@link todo_app_users.id}. Enforces 1:1 relationship between a user and a profile.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id"},"unique":true,"nullable":false}],"plainFields":[{"name":"full_name","type":"string","description":"User's full name for display purposes. Purely presentational; not used for authentication.","nullable":true},{"name":"nickname","type":"string","description":"Optional nickname or handle for casual display contexts.","nullable":true},{"name":"avatar_uri","type":"uri","description":"Optional URI to the user's avatar image resource.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp for the profile.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for the profile.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp of the profile record.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"full_name"},{"fieldName":"nickname"}]},{"name":"todo_app_user_preferences","description":"Per-user preference settings that affect behavior and presentation (e.g., timezone, locale, pagination). Managed via the user context and used to interpret due dates and UI text. One-to-one with {@link todo_app_users}.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_user_id","type":"uuid","description":"Owner user's {@link todo_app_users.id}. One-to-one preference record.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id"},"unique":true,"nullable":false}],"plainFields":[{"name":"timezone","type":"string","description":"IANA timezone identifier (e.g., \"Asia/Seoul\") interpreting due dates and times for this user.","nullable":false},{"name":"locale","type":"string","description":"BCP 47 language tag for UI text conventions (e.g., \"en-US\").","nullable":false},{"name":"page_size","type":"int","description":"Default pagination size for lists. Business rule: 1–100; common default is 20.","nullable":false},{"name":"created_at","type":"datetime","description":"Creation timestamp for the preferences record.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for the preferences record.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp of the preferences record.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["timezone","created_at"]}],"ginIndexes":[]},{"name":"todo_app_guestvisitors","description":"Role assignment history for when a {@link todo_app_users} account holds the guestVisitor role. Stores multiple grant/revoke events over time to preserve audit history. Managed by governance logic; not user-editable. Queries typically order by granted_at and filter by current (revoked_at IS NULL) membership.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_user_id","type":"uuid","description":"Assigned user's {@link todo_app_users.id}. Allows multiple historical assignments for the same user.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id"},"unique":false,"nullable":false}],"plainFields":[{"name":"granted_at","type":"datetime","description":"Timestamp when the guestVisitor role was granted.","nullable":false},{"name":"revoked_at","type":"datetime","description":"Timestamp when the role was revoked. Null when currently active.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp for the role assignment record.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for the role assignment record.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp for retention without hard delete.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["todo_app_user_id","granted_at"]},{"fieldNames":["granted_at","created_at"]}],"ginIndexes":[]},{"name":"todo_app_todousers","description":"Role assignment history for when a {@link todo_app_users} account holds the todoUser role. Supports multiple grant/revoke cycles for auditability. Not user-editable; maintained by system governance workflows.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_user_id","type":"uuid","description":"Assigned user's {@link todo_app_users.id}. Allows multiple historical assignments for the same user.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id"},"unique":false,"nullable":false}],"plainFields":[{"name":"granted_at","type":"datetime","description":"Timestamp when the todoUser role was granted.","nullable":false},{"name":"revoked_at","type":"datetime","description":"Timestamp when the role was revoked. Null when currently active.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp for the role assignment record.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for the role assignment record.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp for retention without hard delete.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["todo_app_user_id","granted_at"]},{"fieldNames":["granted_at","created_at"]}],"ginIndexes":[]},{"name":"todo_app_systemadmins","description":"Role assignment history for when a {@link todo_app_users} account holds the systemAdmin role. Preserves multiple grant/revoke events over time for governance audits. Not user-editable; managed by administrators.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_user_id","type":"uuid","description":"Assigned user's {@link todo_app_users.id}. Allows multiple historical assignments for the same user.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id"},"unique":false,"nullable":false}],"plainFields":[{"name":"granted_at","type":"datetime","description":"Timestamp when the systemAdmin role was granted.","nullable":false},{"name":"revoked_at","type":"datetime","description":"Timestamp when the role was revoked. Null when currently active.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp for the role assignment record.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for the role assignment record.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp for retention without hard delete.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["todo_app_user_id","granted_at"]},{"fieldNames":["granted_at","created_at"]}],"ginIndexes":[]}]},{"filename":"schema-03-auth.prisma","namespace":"Auth","models":[{"name":"todo_app_sessions","description":"Authentication session records for signed-in users. Each session belongs to a single user ({@link todo_app_users}) and tracks issuance, expiration, client metadata, and optional revocation details. Used to authorize access tokens and to support session revocation workflows. Sessions are security-sensitive and typically short-lived.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_user_id","type":"uuid","description":"Owning user's {@link todo_app_users.id}.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id"},"unique":false,"nullable":false}],"plainFields":[{"name":"session_token","type":"string","description":"Opaque, randomly generated session token used to authenticate requests for this session. Must be unique and non-guessable.","nullable":false},{"name":"ip","type":"string","description":"Client IP address (IPv4/IPv6) observed when the session was established or last used.","nullable":true},{"name":"user_agent","type":"string","description":"Client user agent string captured at session creation for security analytics and device recognition.","nullable":true},{"name":"issued_at","type":"datetime","description":"Timestamp when the session was issued.","nullable":false},{"name":"expires_at","type":"datetime","description":"Timestamp when the session expires and is no longer valid.","nullable":false},{"name":"revoked_at","type":"datetime","description":"Timestamp when the session was revoked, if applicable.","nullable":true},{"name":"revoked_reason","type":"string","description":"Human-readable reason for revocation, if known (e.g., user logout, password change, admin action).","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation time.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last update time.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion time if the record is logically removed.","nullable":true}],"uniqueIndexes":[{"fieldNames":["session_token"],"unique":true}],"plainIndexes":[{"fieldNames":["todo_app_user_id","created_at"]},{"fieldNames":["expires_at"]},{"fieldNames":["todo_app_user_id","expires_at"]}],"ginIndexes":[{"fieldName":"user_agent"}]},{"name":"todo_app_refresh_tokens","description":"Refresh token chain for sessions. Each token belongs to one session ({@link todo_app_sessions}) and can optionally reference its parent token for rotation chains. Supports rotation, revocation, and expiry management for long-lived authentication. For security, store only a one-way hash of the raw token in token_hash and avoid persisting plaintext tokens.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_session_id","type":"uuid","description":"Associated session's {@link todo_app_sessions.id}.","relation":{"name":"session","targetModel":"todo_app_sessions","targetField":"id"},"unique":false,"nullable":false},{"name":"parent_id","type":"uuid","description":"Previous refresh token in the rotation chain. Self-reference {@link todo_app_refresh_tokens.id}.","relation":{"name":"parent","targetModel":"todo_app_refresh_tokens","targetField":"id","mappingName":"recursive"},"unique":false,"nullable":true}],"plainFields":[{"name":"token","type":"string","description":"Opaque refresh token value. Deprecated for security; prefer storing only token_hash.","nullable":false},{"name":"token_hash","type":"string","description":"One-way hash (e.g., SHA-256) of the refresh token. Used for lookup and uniqueness to avoid storing plaintext tokens.","nullable":false},{"name":"issued_at","type":"datetime","description":"Timestamp when this refresh token was issued.","nullable":false},{"name":"expires_at","type":"datetime","description":"Timestamp when this refresh token expires.","nullable":false},{"name":"rotated_at","type":"datetime","description":"Timestamp when this token was rotated (replaced) by a child token, if applicable.","nullable":true},{"name":"revoked_at","type":"datetime","description":"Timestamp when this token was revoked, if applicable.","nullable":true},{"name":"revoked_reason","type":"string","description":"Reason for token revocation, if known (e.g., password change, security event).","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation time.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last update time.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion time if the record is logically removed.","nullable":true}],"uniqueIndexes":[{"fieldNames":["token"],"unique":true},{"fieldNames":["token_hash"],"unique":true}],"plainIndexes":[{"fieldNames":["parent_id"]},{"fieldNames":["todo_app_session_id","created_at"]},{"fieldNames":["expires_at"]}],"ginIndexes":[]},{"name":"todo_app_email_verifications","description":"Email verification tokens for account activation or email change flows. Each record targets a specific user ({@link todo_app_users}) and email address and tracks delivery, expiry, and consumption for auditability. For security, store a one-way token_hash instead of plaintext.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_user_id","type":"uuid","description":"Target user's {@link todo_app_users.id}.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id"},"unique":false,"nullable":false}],"plainFields":[{"name":"token","type":"string","description":"Opaque email verification token. Deprecated for security; prefer storing only token_hash.","nullable":false},{"name":"token_hash","type":"string","description":"One-way hash (e.g., SHA-256) of the verification token for lookup and uniqueness.","nullable":false},{"name":"target_email","type":"string","description":"Email address being verified (may be the current or new email for the account).","nullable":false},{"name":"sent_at","type":"datetime","description":"Timestamp when the verification message was sent.","nullable":false},{"name":"expires_at","type":"datetime","description":"Timestamp when the verification token expires.","nullable":false},{"name":"consumed_at","type":"datetime","description":"Timestamp when the token was successfully consumed, if applicable.","nullable":true},{"name":"failure_count","type":"int","description":"Number of failed verification attempts associated with this token for rate-limiting and auditing.","nullable":false},{"name":"consumed_by_ip","type":"string","description":"Client IP address from which the token was consumed, if available.","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation time.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last update time.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion time if the record is logically removed.","nullable":true}],"uniqueIndexes":[{"fieldNames":["token"],"unique":true},{"fieldNames":["token_hash"],"unique":true}],"plainIndexes":[{"fieldNames":["todo_app_user_id","created_at"]},{"fieldNames":["target_email","created_at"]},{"fieldNames":["expires_at"]}],"ginIndexes":[]},{"name":"todo_app_password_resets","description":"Password reset requests and tokens. May reference the user ({@link todo_app_users}) when identifiable, while still allowing privacy-preserving requests by email only. Tracks expiry and consumption for security and audit. For security, store a one-way token_hash instead of plaintext.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_user_id","type":"uuid","description":"Related user's {@link todo_app_users.id} when the email maps to an existing account. Nullable for privacy-preserving requests.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id"},"unique":false,"nullable":true}],"plainFields":[{"name":"email","type":"string","description":"Email address provided for the reset request. Stored for processing and messaging even if no user exists.","nullable":false},{"name":"token","type":"string","description":"Opaque password reset token. Deprecated for security; prefer storing only token_hash.","nullable":false},{"name":"token_hash","type":"string","description":"One-way hash (e.g., SHA-256) of the reset token for lookup and uniqueness.","nullable":false},{"name":"requested_at","type":"datetime","description":"Timestamp when the reset was requested.","nullable":false},{"name":"expires_at","type":"datetime","description":"Timestamp when the reset token expires.","nullable":false},{"name":"consumed_at","type":"datetime","description":"Timestamp when the reset token was used, if applicable.","nullable":true},{"name":"requested_by_ip","type":"string","description":"Client IP address that initiated the reset request, if available.","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation time.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last update time.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion time if the record is logically removed.","nullable":true}],"uniqueIndexes":[{"fieldNames":["token"],"unique":true},{"fieldNames":["token_hash"],"unique":true}],"plainIndexes":[{"fieldNames":["todo_app_user_id"]},{"fieldNames":["email","requested_at"]},{"fieldNames":["expires_at"]}],"ginIndexes":[]},{"name":"todo_app_login_attempts","description":"Per-attempt authentication outcomes for brute-force protection, abuse detection, and security analytics. Attempts may or may not map to an existing user; both are recorded for rate-limiting and forensics.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_user_id","type":"uuid","description":"Resolved user's {@link todo_app_users.id} when the attempted email maps to an account; null otherwise.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id"},"unique":false,"nullable":true}],"plainFields":[{"name":"email","type":"string","description":"Email address used for the login attempt (as entered).","nullable":false},{"name":"success","type":"boolean","description":"Whether the login attempt succeeded (true) or failed (false).","nullable":false},{"name":"ip","type":"string","description":"Client IP address for the attempt.","nullable":false},{"name":"user_agent","type":"string","description":"User agent string of the client, if available.","nullable":true},{"name":"failure_reason","type":"string","description":"Optional reason for failure (e.g., invalid_credentials, suspended).","nullable":true},{"name":"occurred_at","type":"datetime","description":"Timestamp when the attempt occurred.","nullable":false},{"name":"created_at","type":"datetime","description":"Record creation time.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last update time.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion time if the record is logically removed.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["email","occurred_at"]},{"fieldNames":["ip","occurred_at"]},{"fieldNames":["todo_app_user_id","occurred_at"]}],"ginIndexes":[]},{"name":"todo_app_session_revocations","description":"Explicit revocation records for sessions. Enforces one revocation record per session to capture who revoked the session and why. Used to audit logout, security actions, or administrative revocations.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_session_id","type":"uuid","description":"Target session's {@link todo_app_sessions.id}.","relation":{"name":"session","targetModel":"todo_app_sessions","targetField":"id"},"unique":true,"nullable":false}],"plainFields":[{"name":"revoked_at","type":"datetime","description":"Timestamp when the session was revoked.","nullable":false},{"name":"revoked_by","type":"string","description":"Actor category performing the revocation (e.g., user, system, admin).","nullable":false},{"name":"reason","type":"string","description":"Human-readable reason for revocation, if available.","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation time.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last update time.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion time if the record is logically removed.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["revoked_at"]},{"fieldNames":["todo_app_session_id","revoked_at"]}],"ginIndexes":[]}]},{"filename":"schema-04-todos.prisma","namespace":"Todos","models":[{"name":"todo_app_todos","description":"Primary Todo entity managed by end users. Stores owner reference, core textual fields, due date, lifecycle status (open/completed), and temporal fields. Activity and deletion audit data are captured in {@link todo_app_todo_activities} and {@link todo_app_todo_deletion_events}. Ownership is enforced via FK to {@link todo_app_users}.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_user_id","type":"uuid","description":"Owner user's {@link todo_app_users.id}. Establishes ownership and access isolation.","relation":{"name":"owner","targetModel":"todo_app_users","targetFieldName":"id"},"unique":false,"nullable":false}],"plainFields":[{"name":"title","type":"string","description":"Required short text title of the todo. Business rule: 1–120 characters after trimming; must include at least one non-whitespace character.","nullable":false},{"name":"description","type":"string","description":"Optional longer text description of the todo, up to 1000–2000 characters by policy. Not used for derived values.","nullable":true},{"name":"due_at","type":"datetime","description":"Optional due date/time interpreted in the owner’s timezone. Used for overdue/today/future filters; not restricted to future-only unless policy dictates.","nullable":true},{"name":"status","type":"string","description":"Lifecycle status of the todo. Expected values: 'open' or 'completed' (business-level).","nullable":false},{"name":"completed_at","type":"datetime","description":"Timestamp recorded when the todo is marked completed; cleared when reopened.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp for the todo (system-managed).","nullable":false},{"name":"updated_at","type":"datetime","description":"Last modification timestamp for the todo (system-managed).","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp. When set, the todo is excluded from normal listings. Enables recovery windows per policy.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["todo_app_user_id","created_at"]},{"fieldNames":["todo_app_user_id","status","due_at"]},{"fieldNames":["status","due_at"]},{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"title"},{"fieldName":"description"}]},{"name":"todo_app_todo_activities","description":"Historical activity records (audit trail) for todos. Captures append-mostly events such as create, update, complete, reopen, and delete requests with actor and occurred_at time. References {@link todo_app_todos} and {@link todo_app_users}. To preserve audit history beyond parent deletion, the foreign keys are nullable and configured for onDelete: SetNull.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_todo_id","type":"uuid","description":"Target todo’s {@link todo_app_todos.id}. Nullable to preserve audit records if the todo is purged; onDelete: SetNull.","relation":{"name":"todo","targetModel":"todo_app_todos","targetField":"id","onDelete":"SetNull"},"unique":false,"nullable":true},{"name":"todo_app_user_id","type":"uuid","description":"Actor user’s {@link todo_app_users.id}. Nullable to preserve audit records if the user account is purged; onDelete: SetNull.","relation":{"name":"actor","targetModel":"todo_app_users","targetField":"id","onDelete":"SetNull"},"unique":false,"nullable":true}],"plainFields":[{"name":"activity_type","type":"string","description":"Type of activity event. Expected values include: 'create', 'update', 'complete', 'reopen', 'delete'.","nullable":false},{"name":"details","type":"string","description":"Optional human-readable details for the activity (no sensitive secrets).","nullable":true},{"name":"changed_fields","type":"string","description":"Optional list of changed field names for update events (comma-separated or structured text).","nullable":true},{"name":"previous_status","type":"string","description":"Optional prior status value when applicable (e.g., 'open' or 'completed').","nullable":true},{"name":"next_status","type":"string","description":"Optional next status value when applicable (e.g., 'open' or 'completed').","nullable":true},{"name":"occurred_at","type":"datetime","description":"Business-event timestamp when the activity occurred.","nullable":false},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record update timestamp (rarely used; audit records are typically append-only).","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp for erroneous or redacted records under exceptional policies.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["todo_app_todo_id","occurred_at"]},{"fieldNames":["todo_app_user_id","occurred_at"]},{"fieldNames":["activity_type","occurred_at"]},{"fieldNames":["occurred_at"]}],"ginIndexes":[{"fieldName":"details"}]},{"name":"todo_app_todo_deletion_events","description":"Point-in-time deletion audit entries for todos. Records who deleted the todo and when, with optional human-readable reason. Complements soft-delete policy and supports privacy/audit requirements. References {@link todo_app_todos} and {@link todo_app_users}. To preserve audit history beyond parent deletion, the foreign keys are nullable and configured for onDelete: SetNull.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_todo_id","type":"uuid","description":"Deleted todo’s {@link todo_app_todos.id}. Nullable to preserve audit records if the todo is purged; onDelete: SetNull.","relation":{"name":"todo","targetModel":"todo_app_todos","targetField":"id","onDelete":"SetNull"},"unique":false,"nullable":true},{"name":"todo_app_user_id","type":"uuid","description":"Deleting actor’s {@link todo_app_users.id}. Nullable to preserve audit records if the user account is purged; onDelete: SetNull.","relation":{"name":"deleter","targetModel":"todo_app_users","targetField":"id","onDelete":"SetNull"},"unique":false,"nullable":true}],"plainFields":[{"name":"reason","type":"string","description":"Optional human-readable reason or context for deletion (no secrets).","nullable":true},{"name":"occurred_at","type":"datetime","description":"Business-event timestamp when deletion occurred.","nullable":false},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record update timestamp (normally static after insert).","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp used only for administrative redaction under policy.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["todo_app_todo_id","occurred_at"]},{"fieldNames":["todo_app_user_id","occurred_at"]},{"fieldNames":["occurred_at"]}],"ginIndexes":[{"fieldName":"reason"}]}]},{"filename":"schema-05-events.prisma","namespace":"Events","models":[{"name":"todo_app_event_types","description":"Business event taxonomy for todoApp. Each record defines a stable code and human-readable name for a class of events (e.g., \"todo.created\", \"todo.completed\"). Referenced by {@link todo_app_business_events} to classify occurrences. Enables governance (enable/disable types) and consistent analytics grouping across the system.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"code","type":"string","description":"Stable machine-readable identifier of the event type (e.g., \"todo.created\"). Used in integrations and analytics and must remain stable.","nullable":false},{"name":"name","type":"string","description":"Human-readable title of the event type for administration and reporting.","nullable":false},{"name":"description","type":"string","description":"Optional longer description of when and why this event type is emitted.","nullable":true},{"name":"active","type":"boolean","description":"Whether this event type is currently enabled for emission within the system.","nullable":false},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last update timestamp.","nullable":false}],"uniqueIndexes":[{"fieldNames":["code"],"unique":true}],"plainIndexes":[{"fieldNames":["active"]},{"fieldNames":["created_at"]}],"ginIndexes":[]},{"name":"todo_app_business_events","description":"Append-only business event log capturing user-facing domain events across todoApp. Each event references an {@link todo_app_event_types} classification and may optionally reference the actor's {@link todo_app_users} and a target {@link todo_app_todos}. Session context via {@link todo_app_sessions} is optional. Stores raw, non-derived attributes only (timestamps, message, source metadata) for auditability and analytics ingestion. Referential actions are configured to preserve history (Restrict on types; SetNull on optional links).","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_event_type_id","type":"uuid","description":"Event classification reference. Target model's {@link todo_app_event_types.id}","relation":{"name":"eventType","targetModel":"todo_app_event_types","targetField":"id","onDelete":"Restrict"},"unique":false,"nullable":false},{"name":"todo_app_user_id","type":"uuid","description":"Optional actor reference when the event is associated with a signed-in user. Target model's {@link todo_app_users.id}","relation":{"name":"actorUser","targetModel":"todo_app_users","targetField":"id","onDelete":"SetNull"},"unique":false,"nullable":true},{"name":"todo_app_todo_id","type":"uuid","description":"Optional target Todo reference when the event pertains to a specific Todo. Target model's {@link todo_app_todos.id}","relation":{"name":"targetTodo","targetModel":"todo_app_todos","targetField":"id","onDelete":"SetNull"},"unique":false,"nullable":true},{"name":"todo_app_session_id","type":"uuid","description":"Optional session context. Target model's {@link todo_app_sessions.id}","relation":{"name":"session","targetModel":"todo_app_sessions","targetField":"id","onDelete":"SetNull"},"unique":false,"nullable":true}],"plainFields":[{"name":"occurred_at","type":"datetime","description":"Timestamp when the business event actually occurred (domain time).","nullable":false},{"name":"message","type":"string","description":"Optional human-readable message or summary describing the event in business terms (used for search and diagnostics).","nullable":true},{"name":"source","type":"string","description":"Optional emitter or subsystem identifier providing origin context (e.g., \"web\", \"api\", \"job\").","nullable":true},{"name":"external_id","type":"string","description":"Optional external or upstream event identifier to enable idempotency and deduplication across ingestion pipelines.","nullable":true},{"name":"ip","type":"string","description":"Optional best-effort client IP captured at event time for security and analytics use-cases in accordance with policy.","nullable":true},{"name":"user_agent","type":"string","description":"Optional user agent string captured at event time for diagnostics and product analytics.","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation timestamp (ingestion time).","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last update timestamp (system-managed).","nullable":false}],"uniqueIndexes":[{"fieldNames":["source","external_id"],"unique":true}],"plainIndexes":[{"fieldNames":["todo_app_event_type_id","occurred_at"]},{"fieldNames":["todo_app_user_id","occurred_at"]},{"fieldNames":["todo_app_todo_id","occurred_at"]},{"fieldNames":["todo_app_session_id","occurred_at"]},{"fieldNames":["occurred_at"]},{"fieldNames":["ip","occurred_at"]},{"fieldNames":["source","occurred_at"]}],"ginIndexes":[{"fieldName":"message"}]},{"name":"todo_app_event_counters_daily","description":"Daily counters for business events to support KPI queries. Each row summarizes the count of occurrences for an {@link todo_app_event_types} on a given calendar day bucket. Optionally scoped by actor {@link todo_app_users} and/or target {@link todo_app_todos}. Maintained by application processes; contains only raw counts and timestamps (no derived rollups beyond the defined bucket). Referential actions preserve history (Restrict on types; SetNull on optional links).","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_event_type_id","type":"uuid","description":"Classified event type being counted. Target model's {@link todo_app_event_types.id}","relation":{"name":"eventType","targetModel":"todo_app_event_types","targetField":"id","onDelete":"Restrict"},"unique":false,"nullable":false},{"name":"todo_app_user_id","type":"uuid","description":"Optional actor user scope for the daily count. Target model's {@link todo_app_users.id}","relation":{"name":"actorUser","targetModel":"todo_app_users","targetField":"id","onDelete":"SetNull"},"unique":false,"nullable":true},{"name":"todo_app_todo_id","type":"uuid","description":"Optional target Todo scope for the daily count. Target model's {@link todo_app_todos.id}","relation":{"name":"targetTodo","targetModel":"todo_app_todos","targetField":"id","onDelete":"SetNull"},"unique":false,"nullable":true}],"plainFields":[{"name":"bucket_date","type":"datetime","description":"Start of the calendar day (00:00:00) in the chosen reference timezone representing the counting bucket.","nullable":false},{"name":"count","type":"int","description":"Total number of events observed for the specified dimensions within the bucket day.","nullable":false},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last update timestamp.","nullable":false}],"uniqueIndexes":[{"fieldNames":["bucket_date","todo_app_event_type_id","todo_app_user_id","todo_app_todo_id"],"unique":true}],"plainIndexes":[{"fieldNames":["bucket_date"]},{"fieldNames":["todo_app_event_type_id","bucket_date"]},{"fieldNames":["todo_app_user_id","bucket_date"]},{"fieldNames":["todo_app_todo_id","bucket_date"]}],"ginIndexes":[]}]},{"filename":"schema-06-audit.prisma","namespace":"Audit","models":[{"name":"todo_app_audit_logs","description":"Append-only audit trail capturing sensitive operations across the system. Records the acting user (required), optional target user, business action, related resource classification, outcome, and client context. Private todo text values are never stored here. References actors and targets via {@link todo_app_users} to support cross-user isolation and governance reviews. Uses restrictive/set-null deletes to preserve audit history.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"actor_user_id","type":"uuid","description":"Acting user's {@link todo_app_users.id}. Required for attribution and accountability.","relation":{"name":"actorUser","targetModel":"todo_app_users","targetField":"id","onDelete":"Restrict","mappingName":"todo_app_audit_logs_of_actor_user_id"},"unique":false,"nullable":false},{"name":"target_user_id","type":"uuid","description":"Target user's {@link todo_app_users.id}. Optional when no specific user is targeted.","relation":{"name":"targetUser","targetModel":"todo_app_users","targetField":"id","onDelete":"SetNull","mappingName":"todo_app_audit_logs_of_target_user_id"},"unique":false,"nullable":true}],"plainFields":[{"name":"action","type":"string","description":"Business action identifier (e.g., \"login\", \"logout\", \"suspend_account\", \"data_export_request\"). Used for audit classification and search.","nullable":false},{"name":"resource_type","type":"string","description":"Domain resource category or model name associated with the action (e.g., \"todo_app_todos\", \"todo_app_sessions\").","nullable":true},{"name":"resource_id","type":"string","description":"Identifier of the resource related to this event when applicable. String typed to accommodate non-UUID external identifiers.","nullable":true},{"name":"success","type":"boolean","description":"Whether the attempted action succeeded (true) or failed (false).","nullable":false},{"name":"ip","type":"string","description":"Origin IP address captured at the time of the event for security investigation. Stored as text.","nullable":true},{"name":"user_agent","type":"string","description":"Client user-agent string to aid in security investigations. Text only; no parsing or PII extraction here.","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation timestamp (event capture time).","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last update timestamp (operational correction/audit enrichment time).","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp for retention workflows. Null means active/retained.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["actor_user_id","created_at"]},{"fieldNames":["target_user_id","created_at"]},{"fieldNames":["action","created_at"]},{"fieldNames":["resource_type","created_at"]},{"fieldNames":["created_at"]},{"fieldNames":["resource_type","resource_id","created_at"]}],"ginIndexes":[{"fieldName":"action"}]},{"name":"todo_app_admin_actions","description":"Historical records of privileged administrative operations performed by system administrators. Captures who acted, optional target user, the administrative action, stated reason, and operational notes. Does not store private todo content. Supports governance reviews and incident response. Uses restrictive/set-null deletes on FKs to preserve history.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"admin_user_id","type":"uuid","description":"Administrator actor's {@link todo_app_users.id}. Required for privileged actions.","relation":{"name":"adminUser","targetModel":"todo_app_users","targetField":"id","onDelete":"Restrict","mappingName":"todo_app_admin_actions_of_admin_user_id"},"unique":false,"nullable":false},{"name":"target_user_id","type":"uuid","description":"Target user's {@link todo_app_users.id}. Optional for service-wide actions with no specific target.","relation":{"name":"targetUser","targetModel":"todo_app_users","targetField":"id","onDelete":"SetNull","mappingName":"todo_app_admin_actions_of_target_user_id"},"unique":false,"nullable":true}],"plainFields":[{"name":"action","type":"string","description":"Administrative action key (e.g., \"suspend_account\", \"reactivate_account\", \"revoke_sessions\", \"update_service_config\").","nullable":false},{"name":"reason","type":"string","description":"Business reason provided by the administrator for this action. Human readable; avoid private todo text.","nullable":true},{"name":"notes","type":"string","description":"Operational notes relevant to the action. Human readable; avoid private todo text.","nullable":true},{"name":"success","type":"boolean","description":"Whether the administrative action completed successfully.","nullable":false},{"name":"idempotency_key","type":"string","description":"Optional idempotency token to prevent accidental duplicate execution of the same admin action request.","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation timestamp (action capture time).","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last update timestamp (operational correction/audit enrichment time).","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp for retention workflows. Null means active/retained.","nullable":true}],"uniqueIndexes":[{"fieldNames":["idempotency_key"],"unique":true}],"plainIndexes":[{"fieldNames":["admin_user_id","action","created_at"]},{"fieldNames":["target_user_id","created_at"]},{"fieldNames":["action","created_at"]},{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"reason"},{"fieldName":"notes"}]},{"name":"todo_app_account_status_changes","description":"Point-in-time records of account lifecycle changes for users (e.g., pending_verification → active, active → suspended, suspended → active). Provides a complete historical trail for governance and incident investigation. The admin attribution is optional for system-triggered transitions. No private todo text is stored here. Uses restrictive/set-null deletes to preserve history.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"target_user_id","type":"uuid","description":"Subject account's {@link todo_app_users.id}. Required for the status transition record.","relation":{"name":"targetUser","targetModel":"todo_app_users","targetField":"id","onDelete":"Restrict","mappingName":"todo_app_account_status_changes_of_target_user_id"},"unique":false,"nullable":false},{"name":"admin_user_id","type":"uuid","description":"Administrator actor's {@link todo_app_users.id} when manually changed. Null for automated/system transitions.","relation":{"name":"adminUser","targetModel":"todo_app_users","targetField":"id","onDelete":"SetNull","mappingName":"todo_app_account_status_changes_of_admin_user_id"},"unique":false,"nullable":true}],"plainFields":[{"name":"previous_status","type":"string","description":"Previous account status value (e.g., \"pending_verification\", \"active\", \"suspended\", \"deactivated\").","nullable":false},{"name":"new_status","type":"string","description":"New account status value (e.g., \"active\", \"suspended\", \"deactivated\").","nullable":false},{"name":"business_reason","type":"string","description":"Business rationale for the transition. Human readable; avoid private todo text.","nullable":true},{"name":"has_effect","type":"boolean","description":"Indicates whether this transition actually changed the stored status (false for a no-op attempt).","nullable":false},{"name":"created_at","type":"datetime","description":"Record creation timestamp (transition capture time).","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last update timestamp (operational correction/audit enrichment time).","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp for retention workflows. Null means active/retained.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["target_user_id","created_at"]},{"fieldNames":["admin_user_id","created_at"]},{"fieldNames":["new_status","created_at"]},{"fieldNames":["created_at"]}],"ginIndexes":[{"fieldName":"business_reason"}]}]},{"filename":"schema-07-privacy.prisma","namespace":"Privacy","models":[{"name":"todo_app_data_exports","description":"Records of user-initiated personal data export requests for compliance and portability. Each row represents one export job for a specific user with lifecycle timestamps and outcome details. The record references the owner user via {@link todo_app_users}. Typical queries filter by user, status, and creation time; administrators may audit exports across users. No private todo content is stored here, only metadata and the download link when available.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_user_id","type":"uuid","description":"Owner user's {@link todo_app_users.id}.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id"},"unique":false,"nullable":false}],"plainFields":[{"name":"status","type":"string","description":"Export job status (e.g., requested, processing, completed, failed, expired). Used for workflow and monitoring.","nullable":false},{"name":"export_format","type":"string","description":"Requested data export format (e.g., json, csv).","nullable":false},{"name":"download_uri","type":"uri","description":"Secure download URI for the prepared export archive when available. Null until export is ready or if failed.","nullable":true},{"name":"file_size_bytes","type":"int","description":"Size of the generated export archive in bytes, if completed.","nullable":true},{"name":"checksum","type":"string","description":"Checksum (e.g., SHA-256) of the exported archive to allow integrity verification. Stored as plain hex string.","nullable":true},{"name":"status_message","type":"string","description":"Optional human-readable status or failure reason captured during processing. Useful for support and audit.","nullable":true},{"name":"completed_at","type":"datetime","description":"Timestamp when the export finished successfully (or when processing concluded).","nullable":true},{"name":"expires_at","type":"datetime","description":"Timestamp after which the download link is no longer valid.","nullable":true},{"name":"request_ip","type":"string","description":"IP address (string form) captured at the time of export request for traceability.","nullable":true},{"name":"request_user_agent","type":"string","description":"User agent string captured at the time of export request for traceability.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp (request time).","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for the export job record.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp. Allows operational recovery or retention handling per policy.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["todo_app_user_id","created_at"]},{"fieldNames":["status","created_at"]},{"fieldNames":["expires_at","status"]},{"fieldNames":["todo_app_user_id","status","created_at"]}],"ginIndexes":[{"fieldName":"status_message"}]},{"name":"todo_app_account_deletion_requests","description":"User-initiated account deletion workflow records. Each row captures a single deletion request lifecycle including confirmations, scheduling, finalization, or cancellation. References the account {@link todo_app_users} and stores only administrative metadata and reasons (no private content). Used by governance teams to track and enforce data lifecycle policies.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_user_id","type":"uuid","description":"Target account's {@link todo_app_users.id}.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id"},"unique":false,"nullable":false}],"plainFields":[{"name":"status","type":"string","description":"Deletion request status (e.g., pending_confirmation, scheduled, canceled, completed).","nullable":false},{"name":"reason","type":"string","description":"Optional user-provided reason or administrative note for the deletion request.","nullable":true},{"name":"confirmed_at","type":"datetime","description":"Timestamp when the user confirmed the deletion request (e.g., via email).","nullable":true},{"name":"scheduled_purge_at","type":"datetime","description":"Scheduled date/time for purge operations to begin, per policy.","nullable":true},{"name":"processed_at","type":"datetime","description":"Timestamp when deletion processing completed for the account.","nullable":true},{"name":"canceled_at","type":"datetime","description":"Timestamp when the request was canceled or withdrawn by the user.","nullable":true},{"name":"request_ip","type":"string","description":"IP address (string form) captured at the time the deletion request was created.","nullable":true},{"name":"request_user_agent","type":"string","description":"User agent string captured at request time.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp for the deletion request.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for the deletion request.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp for operational needs and retention controls.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["todo_app_user_id","created_at"]},{"fieldNames":["status","created_at"]},{"fieldNames":["scheduled_purge_at","status"]},{"fieldNames":["todo_app_user_id","status","created_at"]}],"ginIndexes":[{"fieldName":"reason"}]},{"name":"todo_app_privacy_consents","description":"Consent records per user and purpose for non-essential processing. Each row represents a specific consent action (granted or revoked) tied to a policy version and timestamps. Historical trail is preserved by new rows rather than updates in place. References the owner via {@link todo_app_users}. Enables compliance queries by user, purpose, and status.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_user_id","type":"uuid","description":"Owner user's {@link todo_app_users.id}.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id"},"unique":false,"nullable":false}],"plainFields":[{"name":"purpose_code","type":"string","description":"System code for the consent purpose (e.g., analytics, marketing_email). Used for programmatic filtering.","nullable":false},{"name":"purpose_name","type":"string","description":"Human-readable purpose name for search and reporting.","nullable":false},{"name":"granted","type":"boolean","description":"Whether consent was granted (true) or denied/withdrawn (false) at the event time.","nullable":false},{"name":"granted_at","type":"datetime","description":"Timestamp when the consent action occurred (grant or deny).","nullable":false},{"name":"revoked_at","type":"datetime","description":"Timestamp when the previously granted consent was revoked. Null if still active or if never granted.","nullable":true},{"name":"expires_at","type":"datetime","description":"Optional expiry for the consent if governed by policy.","nullable":true},{"name":"policy_version","type":"string","description":"Policy or notice version identifier that was in effect at the time of consent.","nullable":false},{"name":"source","type":"string","description":"Where/how the consent was captured (e.g., web, mobile, settings_page).","nullable":true},{"name":"ip","type":"string","description":"IP address (string form) at the time of the consent action.","nullable":true},{"name":"user_agent","type":"string","description":"User agent string at the time of the consent action.","nullable":true},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp for the record.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp for operational recovery/retention.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["todo_app_user_id","purpose_code","granted_at"]},{"fieldNames":["purpose_code","granted","created_at"]}],"ginIndexes":[{"fieldName":"purpose_name"}]}]},{"filename":"schema-08-rate-limits.prisma","namespace":"RateLimits","models":[{"name":"todo_app_rate_limits","description":"System-wide throttling policy definitions. Administrators define and manage these limits for different action categories and scopes. Referenced by {@link todo_app_user_rate_counters} and {@link todo_app_ip_rate_counters} to enforce fair-use and cooldown behavior. Contains only configuration attributes (no counters) to maintain strict 3NF. Typical queries search by category/scope and free-text over name/description.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"code","type":"string","description":"Unique business code identifying the rate limit policy (e.g., \"write_per_minute\"). Used for configuration management and safe references in code or admin tools.","nullable":false},{"name":"name","type":"string","description":"Human-readable name of the policy for admin consoles and documentation.","nullable":false},{"name":"description","type":"string","description":"Detailed admin-facing description of the policy intention, scope, and operational notes.","nullable":true},{"name":"scope","type":"string","description":"Scope of application such as \"user\", \"ip\", or \"global\". Determines the subject dimension to which counters apply.","nullable":false},{"name":"category","type":"string","description":"Functional category of actions affected by this policy, e.g., \"read\", \"write\", or \"auth\".","nullable":false},{"name":"window_seconds","type":"int","description":"Fixed window duration in seconds used to aggregate requests for throttling calculations.","nullable":false},{"name":"max_requests","type":"int","description":"Maximum allowed requests within the window before throttling is applied.","nullable":false},{"name":"burst_size","type":"int","description":"Optional token bucket burst size allowing temporary spikes within the same window. When null, burst is not applied.","nullable":true},{"name":"sliding_window","type":"boolean","description":"Whether the policy uses a sliding window approximation (true) or fixed window (false).","nullable":false},{"name":"enabled","type":"boolean","description":"Administrative toggle to enable or disable enforcement of this policy.","nullable":false},{"name":"created_at","type":"datetime","description":"Creation timestamp of the policy record.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp of the policy record.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp. When set, the policy is considered archived and excluded from normal operations.","nullable":true}],"uniqueIndexes":[{"fieldNames":["code"],"unique":true},{"fieldNames":["category","scope","window_seconds"],"unique":true}],"plainIndexes":[{"fieldNames":["enabled","category"]},{"fieldNames":["scope","enabled"]}],"ginIndexes":[{"fieldName":"name"},{"fieldName":"description"}]},{"name":"todo_app_user_rate_counters","description":"Operational counters for applying rate limits per user. Each record aggregates requests in a specific window for a specific policy. References {@link todo_app_rate_limits} for configuration and {@link todo_app_users} for the subject. Used to determine throttling and cooldowns; not directly managed by end users.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_rate_limit_id","type":"uuid","description":"Associated rate limit policy's {@link todo_app_rate_limits.id}.","relation":{"name":"rateLimit","targetModel":"todo_app_rate_limits","targetField":"id"},"unique":false,"nullable":false},{"name":"todo_app_user_id","type":"uuid","description":"Subject user's {@link todo_app_users.id}.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id"},"unique":false,"nullable":false}],"plainFields":[{"name":"window_started_at","type":"datetime","description":"Start timestamp of the counting window for this user and policy.","nullable":false},{"name":"window_ends_at","type":"datetime","description":"End timestamp of the counting window for this user and policy.","nullable":false},{"name":"count","type":"int","description":"Number of actions recorded within this window for the user under the given policy.","nullable":false},{"name":"last_action_at","type":"datetime","description":"Timestamp of the most recent action contributing to this window's counter.","nullable":true},{"name":"blocked_until","type":"datetime","description":"If throttled, the time until which actions should be blocked for this user under this policy. Null when not blocked.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp of this counter record.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp of this counter record.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp used for archival/cleanup without hard delete.","nullable":true}],"uniqueIndexes":[{"fieldNames":["todo_app_rate_limit_id","todo_app_user_id","window_started_at"],"unique":true}],"plainIndexes":[{"fieldNames":["todo_app_user_id","window_started_at"]},{"fieldNames":["todo_app_rate_limit_id","window_started_at"]},{"fieldNames":["blocked_until","todo_app_rate_limit_id"]},{"fieldNames":["todo_app_user_id","todo_app_rate_limit_id","window_started_at"]},{"fieldNames":["todo_app_user_id","todo_app_rate_limit_id","blocked_until"]}],"ginIndexes":[]},{"name":"todo_app_ip_rate_counters","description":"Operational counters for applying rate limits per IP address. Each record aggregates requests in a specific window for a specific policy. References {@link todo_app_rate_limits} for configuration. Intended for abuse mitigation where user identity is absent or unreliable.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_rate_limit_id","type":"uuid","description":"Associated rate limit policy's {@link todo_app_rate_limits.id}.","relation":{"name":"rateLimit","targetModel":"todo_app_rate_limits","targetField":"id"},"unique":false,"nullable":false}],"plainFields":[{"name":"ip","type":"string","description":"Client IP address (IPv4 or IPv6 in text form) used as the subject key for this counter.","nullable":false},{"name":"window_started_at","type":"datetime","description":"Start timestamp of the counting window for this IP and policy.","nullable":false},{"name":"window_ends_at","type":"datetime","description":"End timestamp of the counting window for this IP and policy.","nullable":false},{"name":"count","type":"int","description":"Number of actions recorded within this window for the IP under the given policy.","nullable":false},{"name":"last_action_at","type":"datetime","description":"Timestamp of the most recent action contributing to this window's counter.","nullable":true},{"name":"blocked_until","type":"datetime","description":"If throttled, the time until which actions should be blocked for this IP under this policy. Null when not blocked.","nullable":true},{"name":"created_at","type":"datetime","description":"Creation timestamp of this counter record.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp of this counter record.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp used for archival/cleanup without hard delete.","nullable":true}],"uniqueIndexes":[{"fieldNames":["todo_app_rate_limit_id","ip","window_started_at"],"unique":true}],"plainIndexes":[{"fieldNames":["ip","window_started_at"]},{"fieldNames":["todo_app_rate_limit_id","window_started_at"]},{"fieldNames":["blocked_until","todo_app_rate_limit_id"]},{"fieldNames":["ip","todo_app_rate_limit_id","window_started_at"]},{"fieldNames":["ip","todo_app_rate_limit_id","blocked_until"]}],"ginIndexes":[]}]},{"filename":"schema-09-metrics.prisma","namespace":"Metrics","models":[{"name":"todo_app_aggregated_metrics","description":"Historical aggregated metrics snapshots for the todo application. Each row captures a metric value over a defined time window and optional dimensions (e.g., by user or event type). This table preserves time-series history for auditability and trend analysis. It references existing domain entities for dimensional filtering but does not duplicate their attributes. Related materialized views like {@link mv_todo_app_daily_stats} and {@link mv_todo_app_kpi_counters} provide read-optimized rollups.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"todo_app_user_id","type":"uuid","description":"Optional owner dimension for the metric snapshot. Target model's {@link todo_app_users.id}.","relation":{"name":"user","targetModel":"todo_app_users","targetField":"id","onDelete":"SetNull"},"unique":false,"nullable":true},{"name":"todo_app_event_type_id","type":"uuid","description":"Optional event type dimension for the metric snapshot. Target model's {@link todo_app_event_types.id}.","relation":{"name":"eventType","targetModel":"todo_app_event_types","targetField":"id","onDelete":"SetNull"},"unique":false,"nullable":true}],"plainFields":[{"name":"metric_key","type":"string","description":"Business metric identifier (e.g., 'todos.created', 'todos.completed', 'latency.p95'). Used to group and query snapshots.","nullable":false},{"name":"granularity","type":"string","description":"Time bucket level of aggregation such as 'hour', 'day', 'week', or 'month'.","nullable":false},{"name":"period_start","type":"datetime","description":"Inclusive start timestamp of the snapshot's aggregation window in UTC.","nullable":false},{"name":"period_end","type":"datetime","description":"Exclusive end timestamp of the snapshot's aggregation window in UTC.","nullable":false},{"name":"value","type":"double","description":"Aggregated numeric value for the metric within the period window.","nullable":false},{"name":"unit","type":"string","description":"Measurement unit of the value (e.g., 'count', 'ms', 'hours').","nullable":false},{"name":"created_at","type":"datetime","description":"Record creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Record last update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp. Null when active.","nullable":true}],"uniqueIndexes":[{"fieldNames":["metric_key","granularity","period_start","period_end","todo_app_user_id","todo_app_event_type_id"],"unique":true}],"plainIndexes":[{"fieldNames":["period_start","period_end"]},{"fieldNames":["metric_key","period_start"]},{"fieldNames":["todo_app_user_id","period_start"]},{"fieldNames":["granularity","period_start"]},{"fieldNames":["todo_app_event_type_id","period_start"]}],"ginIndexes":[{"fieldName":"metric_key"}]},{"name":"mv_todo_app_daily_stats","description":"Materialized daily statistics for the todo application. Provides read-optimized, denormalized counts and ratios per calendar day to power dashboards and reports without scanning raw events. Derived from snapshot tables and event/audit sources. Related base snapshots: {@link todo_app_aggregated_metrics}.","material":true,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"stats_date","type":"datetime","description":"Calendar date represented at start-of-day (00:00:00) in UTC for which the stats apply.","nullable":false},{"name":"todos_created","type":"int","description":"Number of todos created on stats_date.","nullable":false},{"name":"todos_completed","type":"int","description":"Number of todos completed on stats_date.","nullable":false},{"name":"active_users","type":"int","description":"Distinct count of active users performing at least one tracked action on stats_date.","nullable":false},{"name":"completion_ratio","type":"double","description":"Ratio of completed todos to created todos for stats_date. Computed/derived in MV.","nullable":false},{"name":"refreshed_at","type":"datetime","description":"Timestamp when this MV row was last refreshed from source data.","nullable":false},{"name":"created_at","type":"datetime","description":"MV row creation timestamp in the materialized cache.","nullable":false},{"name":"updated_at","type":"datetime","description":"MV row last refresh timestamp in the materialized cache.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp for MV row if removed from active view logic.","nullable":true}],"uniqueIndexes":[{"fieldNames":["stats_date"],"unique":true}],"plainIndexes":[{"fieldNames":["stats_date","updated_at"]}],"ginIndexes":[]},{"name":"mv_todo_app_kpi_counters","description":"Materialized KPI counters over sliding or fixed windows for dashboards and SLO monitoring. Captures high-level indicators such as counts and latency/throughput KPIs without scanning raw data. Derived and read-only. Related base: {@link todo_app_aggregated_metrics}.","material":true,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"window_start","type":"datetime","description":"Inclusive start of the KPI window in UTC.","nullable":false},{"name":"window_end","type":"datetime","description":"Exclusive end of the KPI window in UTC.","nullable":false},{"name":"todos_created","type":"int","description":"Total number of todos created within the KPI window.","nullable":false},{"name":"todos_completed","type":"int","description":"Total number of todos completed within the KPI window.","nullable":false},{"name":"active_users","type":"int","description":"Distinct count of active users within the KPI window.","nullable":false},{"name":"avg_time_to_complete_hours","type":"double","description":"Average time to complete a todo within the window (hours). May be null when insufficient data.","nullable":true},{"name":"p95_completion_time_hours","type":"double","description":"95th percentile time to complete a todo within the window (hours). May be null when insufficient data.","nullable":true},{"name":"refreshed_at","type":"datetime","description":"Timestamp when this MV row was last refreshed from source data.","nullable":false},{"name":"created_at","type":"datetime","description":"MV row creation timestamp in the materialized cache.","nullable":false},{"name":"updated_at","type":"datetime","description":"MV row last refresh timestamp in the materialized cache.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp for MV row if removed from active view logic.","nullable":true}],"uniqueIndexes":[{"fieldNames":["window_start","window_end"],"unique":true}],"plainIndexes":[{"fieldNames":["window_end","updated_at"]}],"ginIndexes":[]}]}]}